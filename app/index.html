<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Kanban</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="purecss/build/pure-min.css">
    <link rel="stylesheet" href="purecss/build/grids-responsive-min.css">
    <link rel="stylesheet" href="assets/css/pricing.css">
    <link rel="stylesheet" href="assets/css/main.css">
</head>

<body uku-application>

    <div class="pure-g">
        <div class="pure-u-1-2 left-container">
            <div class="pure-g">
                <div class="pure-u-1-2">
                    <weather-today uku-city="appCtrl.city"></weather-today>
                    <weather-4-days uku-weathers="appCtrl.weathers"></weather-4-days>
                </div>
                <div class="pure-u-1-2">
                    <community-annoucement></community-annoucement>
                    <community-activity></community-activity>
                </div>
            </div>
        </div>
        <div class="pure-u-1-2 right-container">
            <real-data class="real-data-panel"></real-data>
        </div>
    </div>
</body>
<script src="ukulelejs/dist/uku.js"></script>
<script src="services/weather_service.js"></script>
<script>
    var uku = new Ukulele();
    var appCtrl = new ApplicationController(uku);
    var weatherService = new WeatherService();
    uku.registerController('appCtrl', appCtrl);
    uku.registerComponent('real-data', 'components/real_data.html');
    uku.registerComponent('percent-item', 'components/percent_item.html');
    uku.registerComponent('weather-today','components/weather_today.html');
    uku.registerComponent('weather-4-days','components/weather_4_days.html');
    uku.registerComponent('community-annoucement','components/community_annoucement.html');
    uku.registerComponent('community-activity','components/community_activity.html');
    uku.init();


    uku.addListener(Ukulele.INITIALIZED, function () {
        console.log('Ukulele initialized');
        appCtrl.init();
    });

    function ApplicationController(uku) {
        var self = this;
        this.init = function(){
            weatherService.get().then(function(result){
                console.log(result);
                self.city = result.results[0];
                self.weathers = self.city.weather_data;
                uku.refresh('appCtrl');
            });
        };
        this.percent1 = 79;
        this.config1 = {
            title: '土壤',
            color: '#CE8D66',
            color_gray: '#cccccc',
            icon: 'assets/images/plant.svg'
        };
        this.percent2 = 23;
        this.config2 = {
            title: '日照强度',
            color: '#EE4B6A',
            color_gray: '#cccccc',
            icon: 'assets/images/sun.svg'
        };
        this.percent3 = 50;
        this.config3 = {
            title: '土壤湿度',
            color: '#17BEBB',
            color_gray: '#cccccc',
            icon: 'assets/images/water.svg'
        };
        this.percent4 = 20;
        this.config4 = {
            title: '空气湿度',
            color: '#009DDC',
            color_gray: '#cccccc',
            icon: 'assets/images/drop.svg'
        };
    }
</script>

</html>